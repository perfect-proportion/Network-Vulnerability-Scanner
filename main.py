from src.scanner import scan_network, parse_results
from src.vulnerability_checker import check_vulnerabilities

def main():
    network = '192.168.1.0/24'  # Replace with target network
    print(f"Scanning network: {network}")
    scan_network(network)
    results = parse_results('scan_results.xml')
    vulnerabilities = check_vulnerabilities(results)
    
    print("\nScan Results:")
    for vuln in vulnerabilities:
        print(f"IP: {vuln['ip']}, Port: {vuln['port']}, Service: {vuln['service']}, "
              f"Version: {vuln['version']}, Vulnerability: {vuln['vulnerability']}")

if __name__ == "__main__":
    main()