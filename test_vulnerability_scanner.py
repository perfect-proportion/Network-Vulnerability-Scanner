import unittest
from src.vulnerability_checker import check_vulnerabilities

class TestVulnerabilityChecker(unittest.TestCase):
    def test_check_vulnerabilities(self):
        mock_results = [
            {'ip': '192.168.1.1', 'port': '80', 'service': 'apache', 'version': '2.4.29'},
            {'ip': '192.168.1.2', 'port': '22', 'service': 'ssh', 'version': '7.6p1'}
        ]
        vulnerabilities = check_vulnerabilities(mock_results)
        self.assertEqual(len(vulnerabilities), 2)
        self.assertEqual(vulnerabilities[0]['vulnerability'], 'CVE-2021-44228')
        self.assertEqual(vulnerabilities[1]['vulnerability'], 'CVE-2020-14145')

if __name__ == '__main__':
    unittest.main()